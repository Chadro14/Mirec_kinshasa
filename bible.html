<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>La Sainte Bible - MIREC</title>
    <link rel="stylesheet" href="style.css"> 
</head>
<body>
    <header>
        <nav>
            <a href="dashbord.html">← Retour au Tableau de Bord</a>
        </nav>
        <h1>La Sainte Bible (Louis Segond)</h1>
    </header>

    <main>
        
        <section id="bible-text-display">
            <h2>Verset du Jour (Jean 3:16)</h2>
            <div id="bible-content">
                <p>Chargement du Verset...</p>
            </div>
            <p>
                <small>Traduction: Louis Segond (1910) - API: bible-api.com</small>
            </p>
        </section>

        <section id="bible-search">
            <h2>Rechercher un autre Verset</h2>
            <p>
                <small>Exemples de recherche : Jean 1:1, Genèse 1:26, Psaumes 23</small>
            </p>
            <input type="text" id="searchInput" placeholder="Entrez la référence (ex: Jean 3:16)">
            <button onclick="fetchBibleVerse()">Rechercher</button>
            
            <div id="search-result"></div>
        </section>
        
        <script>
            // Fonction principale pour interroger l'API
            function fetchBibleVerse(reference = 'Jean 3:16') {
                const translation = 'lsg'; // Louis Segond (français)
                const apiUrl = `https://bible-api.com/${encodeURIComponent(reference)}?translation=${translation}`;
                
                const outputElement = (reference === 'Jean 3:16') ? 
                                       document.getElementById('bible-content') : 
                                       document.getElementById('search-result');

                outputElement.innerHTML = `<p>Chargement de ${reference}...</p>`;

                fetch(apiUrl)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Référence non trouvée ou erreur réseau.');
                        }
                        return response.json();
                    })
                    .then(data => {
                        // Construire le texte à partir des versets reçus
                        let text = '';
                        if (data.verses && data.verses.length > 0) {
                            text = data.verses.map(v => `<strong>${v.verse}</strong> ${v.text}`).join(' ');
                            
                            outputElement.innerHTML = `
                                <h3>${data.reference}</h3>
                                <p>${text}</p>
                            `;
                        } else {
                            // Cas où la référence n'est pas valide mais la requête est OK (souvent un tableau vide)
                            outputElement.innerHTML = `<p>Désolé, la référence "${reference}" n'a pas pu être trouvée dans la version LSG.</p>`;
                        }
                    })
                    .catch(error => {
                        // Afficher l'erreur dans la zone de contenu
                        outputElement.innerHTML = `<p>Erreur: ${error.message}. Veuillez vérifier la référence.</p>`;
                        console.error('Erreur API:', error);
                    });
            }

            // Fonction appelée par le bouton de recherche
            function fetchBibleVerseFromInput() {
                const input = document.getElementById('searchInput').value.trim();
                if (input) {
                    fetchBibleVerse(input);
                } else {
                    document.getElementById('search-result').innerHTML = `<p>Veuillez entrer une référence biblique valide.</p>`;
                }
            }
            
            // Lancer le chargement du verset par défaut au chargement de la page
            window.onload = function() {
                fetchBibleVerse();
                
                // Lie la touche "Entrée" à la recherche pour améliorer l'expérience
                document.getElementById('searchInput').addEventListener('keyup', function(event) {
                    if (event.key === 'Enter') {
                        fetchBibleVerseFromInput();
                    }
                });
            };
        </script>
    </main>

    <footer>
        <p>Source Bible via API externe. Développé par Son Altesse.</p>
    </footer>
</body>
</html>
